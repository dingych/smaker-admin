{"remainingRequest":"D:\\work\\工作\\文旅\\基础架构\\pig-ui\\node_modules\\babel-loader\\lib\\index.js!D:\\work\\工作\\文旅\\基础架构\\pig-ui\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\work\\工作\\文旅\\基础架构\\pig-ui\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\work\\工作\\文旅\\基础架构\\pig-ui\\src\\views\\admin\\menu\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\work\\工作\\文旅\\基础架构\\pig-ui\\src\\views\\admin\\menu\\index.vue","mtime":1551667984257},{"path":"D:\\work\\工作\\文旅\\基础架构\\pig-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\work\\工作\\文旅\\基础架构\\pig-ui\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\work\\工作\\文旅\\基础架构\\pig-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\work\\工作\\文旅\\基础架构\\pig-ui\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _parseInt from \"D:\\\\work\\\\\\u5DE5\\u4F5C\\\\\\u6587\\u65C5\\\\\\u57FA\\u7840\\u67B6\\u6784\\\\pig-ui\\\\node_modules\\\\@babel\\\\runtime-corejs2/core-js/parse-int\";\nimport _objectSpread from \"D:\\\\work\\\\\\u5DE5\\u4F5C\\\\\\u6587\\u65C5\\\\\\u57FA\\u7840\\u67B6\\u6784\\\\pig-ui\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/objectSpread\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { addObj, delObj, fetchMenuTree, getObj, putObj } from '@/api/admin/menu';\nimport { mapGetters } from 'vuex';\nexport default {\n  name: 'menu',\n  data: function data() {\n    return {\n      list: null,\n      total: null,\n      formEdit: true,\n      formAdd: true,\n      formStatus: '',\n      showElement: false,\n      typeOptions: ['0', '1'],\n      methodOptions: ['GET', 'POST', 'PUT', 'DELETE'],\n      listQuery: {\n        name: undefined\n      },\n      treeData: [],\n      oExpandedKey: {// key (from tree id) : expandedOrNot boolean\n      },\n      oTreeNodeChildren: {// id1 : [children] (from tree node id1)\n        // id2 : [children] (from tree node id2)\n      },\n      aExpandedKeys: [],\n      defaultProps: {\n        children: 'children',\n        label: 'name'\n      },\n      labelPosition: 'right',\n      form: {\n        permission: undefined,\n        name: undefined,\n        menuId: undefined,\n        parentId: undefined,\n        icon: undefined,\n        sort: undefined,\n        component: undefined,\n        type: undefined,\n        path: undefined\n      },\n      currentId: -1,\n      menuManager_btn_add: false,\n      menuManager_btn_edit: false,\n      menuManager_btn_del: false\n    };\n  },\n  filters: {\n    typeFilter: function typeFilter(type) {\n      var typeMap = {\n        0: '菜单',\n        1: '按钮'\n      };\n      return typeMap[type];\n    }\n  },\n  created: function created() {\n    this.getList();\n    this.menuManager_btn_add = this.permissions['sys_menu_add'];\n    this.menuManager_btn_edit = this.permissions['sys_menu_edit'];\n    this.menuManager_btn_del = this.permissions['sys_menu_del'];\n  },\n  computed: _objectSpread({}, mapGetters(['elements', 'permissions'])),\n  methods: {\n    getList: function getList() {\n      var _this = this;\n\n      fetchMenuTree(this.listQuery).then(function (response) {\n        _this.treeData = response.data.data;\n      });\n    },\n    filterNode: function filterNode(value, data) {\n      if (!value) return true;\n      return data.label.indexOf(value) !== -1;\n    },\n    nodeExpand: function nodeExpand(data) {\n      var aChildren = data.children;\n\n      if (aChildren.length > 0) {\n        this.oExpandedKey[data.id] = true;\n        this.oTreeNodeChildren[data.id] = aChildren;\n      }\n\n      this.setExpandedKeys();\n    },\n    nodeCollapse: function nodeCollapse(data) {\n      var _this2 = this;\n\n      this.oExpandedKey[data.id] = false; // 如果有子节点\n\n      this.treeRecursion(this.oTreeNodeChildren[data.id], function (oNode) {\n        _this2.oExpandedKey[oNode.id] = false;\n      });\n      this.setExpandedKeys();\n    },\n    setExpandedKeys: function setExpandedKeys() {\n      var oTemp = this.oExpandedKey;\n      this.aExpandedKeys = [];\n\n      for (var sKey in oTemp) {\n        if (oTemp[sKey]) {\n          this.aExpandedKeys.push(_parseInt(sKey));\n        }\n      }\n    },\n    treeRecursion: function treeRecursion(aChildren, fnCallback) {\n      if (aChildren) {\n        for (var i = 0; i < aChildren.length; ++i) {\n          var oNode = aChildren[i];\n          fnCallback && fnCallback(oNode);\n          this.treeRecursion(oNode.children, fnCallback);\n        }\n      }\n    },\n    getNodeData: function getNodeData(data) {\n      var _this3 = this;\n\n      if (!this.formEdit) {\n        this.formStatus = 'update';\n      }\n\n      getObj(data.id).then(function (response) {\n        _this3.form = response.data.data;\n      });\n      this.currentId = data.id;\n      this.showElement = true;\n    },\n    handlerEdit: function handlerEdit() {\n      if (this.form.menuId) {\n        this.formEdit = false;\n        this.formStatus = 'update';\n      }\n    },\n    handlerAdd: function handlerAdd() {\n      this.resetForm();\n      this.formEdit = false;\n      this.formStatus = 'create';\n    },\n    handleDelete: function handleDelete() {\n      var _this4 = this;\n\n      this.$confirm('此操作将永久删除, 是否继续?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(function () {\n        delObj(_this4.currentId).then(function () {\n          _this4.getList();\n\n          _this4.resetForm();\n\n          _this4.onCancel();\n\n          _this4.$notify({\n            title: '成功',\n            message: '删除成功',\n            type: 'success',\n            duration: 2000\n          });\n        });\n      });\n    },\n    update: function update() {\n      var _this5 = this;\n\n      putObj(this.form).then(function () {\n        _this5.getList();\n\n        _this5.$notify({\n          title: '成功',\n          message: '更新成功',\n          type: 'success',\n          duration: 2000\n        });\n      });\n    },\n    create: function create() {\n      var _this6 = this;\n\n      addObj(this.form).then(function () {\n        _this6.getList();\n\n        _this6.$notify({\n          title: '成功',\n          message: '创建成功',\n          type: 'success',\n          duration: 2000\n        });\n      });\n    },\n    onCancel: function onCancel() {\n      this.formEdit = true;\n      this.formStatus = '';\n    },\n    resetForm: function resetForm() {\n      this.form = {\n        permission: undefined,\n        name: undefined,\n        menuId: undefined,\n        parentId: this.currentId,\n        icon: undefined,\n        sort: undefined,\n        component: undefined,\n        type: undefined,\n        path: undefined\n      };\n    }\n  }\n};",{"version":3,"sources":["index.vue"],"names":[],"mappings":"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","sourcesContent":["<!--\r\n  -    Copyright (c) 2018-2025, lengleng All rights reserved.\r\n  -\r\n  - Redistribution and use in source and binary forms, with or without\r\n  - modification, are permitted provided that the following conditions are met:\r\n  -\r\n  - Redistributions of source code must retain the above copyright notice,\r\n  - this list of conditions and the following disclaimer.\r\n  - Redistributions in binary form must reproduce the above copyright\r\n  - notice, this list of conditions and the following disclaimer in the\r\n  - documentation and/or other materials provided with the distribution.\r\n  - Neither the name of the pig4cloud.com developer nor the names of its\r\n  - contributors may be used to endorse or promote products derived from\r\n  - this software without specific prior written permission.\r\n  - Author: lengleng (wangiegie@gmail.com)\r\n  -->\r\n\r\n<template>\r\n  <div class=\"app-container calendar-list-container\">\r\n    <basic-container>\r\n      <div class=\"filter-container\">\r\n        <el-button-group>\r\n          <el-button type=\"primary\"\r\n                     v-if=\"menuManager_btn_add\"\r\n                     icon=\"plus\"\r\n                     @click=\"handlerAdd\">添加\r\n          </el-button>\r\n          <el-button type=\"primary\"\r\n                     v-if=\"menuManager_btn_edit\"\r\n                     icon=\"edit\"\r\n                     @click=\"handlerEdit\">编辑\r\n          </el-button>\r\n          <el-button type=\"primary\"\r\n                     v-if=\"menuManager_btn_del\"\r\n                     icon=\"delete\"\r\n                     @click=\"handleDelete\">删除\r\n          </el-button>\r\n        </el-button-group>\r\n      </div>\r\n\r\n      <el-row>\r\n        <el-col :span=\"8\"\r\n                style='margin-top:15px;'>\r\n          <el-tree class=\"filter-tree\"\r\n                   node-key=\"id\"\r\n                   highlight-current\r\n                   :data=\"treeData\"\r\n                   :default-expanded-keys=\"aExpandedKeys\"\r\n                   :filter-node-method=\"filterNode\"\r\n                   :props=\"defaultProps\"\r\n                   @node-click=\"getNodeData\"\r\n                   @node-expand=\"nodeExpand\"\r\n                   @node-collapse=\"nodeCollapse\">\r\n          </el-tree>\r\n        </el-col>\r\n        <el-col :span=\"16\"\r\n                style='margin-top:15px;'>\r\n          <el-card class=\"box-card\">\r\n            <el-form :label-position=\"labelPosition\"\r\n                     label-width=\"80px\"\r\n                     :model=\"form\"\r\n                     ref=\"form\">\r\n              <el-form-item label=\"父级节点\"\r\n                            prop=\"parentId\">\r\n                <el-input v-model=\"form.parentId\"\r\n                          :disabled=\"true\"\r\n                          placeholder=\"请输入父级节点\"></el-input>\r\n              </el-form-item>\r\n              <el-form-item label=\"节点ID\"\r\n                            prop=\"menuId\">\r\n                <el-input v-model=\"form.menuId\"\r\n                          :disabled=\"formEdit || form.menuId\"\r\n                          placeholder=\"请输入节点ID\"></el-input>\r\n              </el-form-item>\r\n              <el-form-item label=\"标题\"\r\n                            prop=\"name\">\r\n                <el-input v-model=\"form.name\"\r\n                          :disabled=\"formEdit\"\r\n                          placeholder=\"请输入标题\"></el-input>\r\n              </el-form-item>\r\n              <el-form-item label=\"权限标识\"\r\n                            prop=\"permission\">\r\n                <el-input v-model=\"form.permission\"\r\n                          :disabled=\"formEdit\"\r\n                          placeholder=\"请输入权限标识\"></el-input>\r\n              </el-form-item>\r\n              <el-form-item label=\"图标\"\r\n                            prop=\"icon\">\r\n                <el-input v-model=\"form.icon\"\r\n                          :disabled=\"formEdit\"\r\n                          placeholder=\"请输入图标\"></el-input>\r\n              </el-form-item>\r\n              <el-form-item label=\"类型\"\r\n                            prop=\"type\">\r\n                <el-select class=\"filter-item\"\r\n                           v-model=\"form.type\"\r\n                           :disabled=\"formEdit\"\r\n                           placeholder=\"请输入资源请求类型\">\r\n                  <el-option v-for=\"item in  typeOptions\"\r\n                             :key=\"item\"\r\n                             :label=\"item | typeFilter\"\r\n                             :value=\"item\"></el-option>\r\n                </el-select>\r\n              </el-form-item>\r\n              <el-form-item label=\"排序\"\r\n                            prop=\"sort\">\r\n                <el-input type=\"number\"\r\n                          v-model=\"form.sort\"\r\n                          :disabled=\"formEdit\"\r\n                          placeholder=\"请输入排序\"></el-input>\r\n              </el-form-item>\r\n              <el-form-item label=\"前端组件\"\r\n                            prop=\"component\">\r\n                <el-input v-model=\"form.component\"\r\n                          :disabled=\"formEdit\"\r\n                          placeholder=\"请输入描述\"></el-input>\r\n              </el-form-item>\r\n              <el-form-item label=\"前端地址\"\r\n                            prop=\"component\">\r\n                <el-input v-model=\"form.path\"\r\n                          :disabled=\"formEdit\"\r\n                          placeholder=\"iframe嵌套地址\"></el-input>\r\n              </el-form-item>\r\n              <el-form-item label=\"路由缓冲\"\r\n                            prop=\"component\">\r\n                <el-switch v-model=\"form.keepAlive\"\r\n                           :disabled=\"formEdit\"\r\n                           active-color=\"#13ce66\"\r\n                           inactive-color=\"#ff4949\"\r\n                           :active-value='\"1\"'\r\n                           :inactive-value='\"0\"'>\r\n                </el-switch>\r\n              </el-form-item>\r\n              <el-form-item v-if=\"formStatus == 'update'\">\r\n                <el-button type=\"primary\"\r\n                           @click=\"update\">更新\r\n                </el-button>\r\n                <el-button @click=\"onCancel\">取消</el-button>\r\n              </el-form-item>\r\n              <el-form-item v-if=\"formStatus == 'create'\">\r\n                <el-button type=\"primary\"\r\n                           @click=\"create\">保存\r\n                </el-button>\r\n                <el-button @click=\"onCancel\">取消</el-button>\r\n              </el-form-item>\r\n            </el-form>\r\n          </el-card>\r\n        </el-col>\r\n      </el-row>\r\n    </basic-container>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  import {addObj, delObj, fetchMenuTree, getObj, putObj} from '@/api/admin/menu'\r\n  import {mapGetters} from 'vuex'\r\n\r\n  export default {\r\n    name: 'menu',\r\n    data() {\r\n      return {\r\n        list: null,\r\n        total: null,\r\n        formEdit: true,\r\n        formAdd: true,\r\n        formStatus: '',\r\n        showElement: false,\r\n        typeOptions: ['0', '1'],\r\n        methodOptions: ['GET', 'POST', 'PUT', 'DELETE'],\r\n        listQuery: {\r\n          name: undefined\r\n        },\r\n        treeData: [],\r\n        oExpandedKey: {\r\n          // key (from tree id) : expandedOrNot boolean\r\n        },\r\n        oTreeNodeChildren: {\r\n          // id1 : [children] (from tree node id1)\r\n          // id2 : [children] (from tree node id2)\r\n        },\r\n        aExpandedKeys: [],\r\n        defaultProps: {\r\n          children: 'children',\r\n          label: 'name'\r\n        },\r\n        labelPosition: 'right',\r\n        form: {\r\n          permission: undefined,\r\n          name: undefined,\r\n          menuId: undefined,\r\n          parentId: undefined,\r\n          icon: undefined,\r\n          sort: undefined,\r\n          component: undefined,\r\n          type: undefined,\r\n          path: undefined\r\n        },\r\n        currentId: -1,\r\n        menuManager_btn_add: false,\r\n        menuManager_btn_edit: false,\r\n        menuManager_btn_del: false\r\n      }\r\n    },\r\n    filters: {\r\n      typeFilter(type) {\r\n        const typeMap = {\r\n          0: '菜单',\r\n          1: '按钮'\r\n        }\r\n        return typeMap[type]\r\n      }\r\n    },\r\n    created() {\r\n      this.getList()\r\n      this.menuManager_btn_add = this.permissions['sys_menu_add']\r\n      this.menuManager_btn_edit = this.permissions['sys_menu_edit']\r\n      this.menuManager_btn_del = this.permissions['sys_menu_del']\r\n    },\r\n    computed: {\r\n      ...mapGetters([\r\n        'elements',\r\n        'permissions'\r\n      ])\r\n    },\r\n    methods: {\r\n      getList() {\r\n        fetchMenuTree(this.listQuery).then(response => {\r\n          this.treeData = response.data.data\r\n        })\r\n      },\r\n      filterNode(value, data) {\r\n        if (!value) return true\r\n        return data.label.indexOf(value) !== -1\r\n      },\r\n\r\n      nodeExpand(data) {\r\n        let aChildren = data.children\r\n        if (aChildren.length > 0) {\r\n          this.oExpandedKey[data.id] = true\r\n          this.oTreeNodeChildren[data.id] = aChildren\r\n        }\r\n        this.setExpandedKeys()\r\n      },\r\n      nodeCollapse(data) {\r\n        this.oExpandedKey[data.id] = false\r\n        // 如果有子节点\r\n        this.treeRecursion(this.oTreeNodeChildren[data.id], (oNode) => {\r\n          this.oExpandedKey[oNode.id] = false\r\n        });\r\n        this.setExpandedKeys()\r\n      },\r\n      setExpandedKeys() {\r\n        let oTemp = this.oExpandedKey\r\n        this.aExpandedKeys = []\r\n        for (let sKey in oTemp) {\r\n          if (oTemp[sKey]) {\r\n            this.aExpandedKeys.push(parseInt(sKey));\r\n          }\r\n        }\r\n      },\r\n      treeRecursion(aChildren, fnCallback) {\r\n        if (aChildren) {\r\n          for (let i = 0; i < aChildren.length; ++i) {\r\n            let oNode = aChildren[i]\r\n            fnCallback && fnCallback(oNode)\r\n            this.treeRecursion(oNode.children, fnCallback)\r\n          }\r\n        }\r\n      },\r\n\r\n      getNodeData(data) {\r\n        if (!this.formEdit) {\r\n          this.formStatus = 'update'\r\n        }\r\n        getObj(data.id).then(response => {\r\n          this.form = response.data.data\r\n        })\r\n        this.currentId = data.id\r\n        this.showElement = true\r\n      },\r\n      handlerEdit() {\r\n        if (this.form.menuId) {\r\n          this.formEdit = false\r\n          this.formStatus = 'update'\r\n        }\r\n      },\r\n      handlerAdd() {\r\n        this.resetForm()\r\n        this.formEdit = false\r\n        this.formStatus = 'create'\r\n      },\r\n      handleDelete() {\r\n        this.$confirm('此操作将永久删除, 是否继续?', '提示', {\r\n          confirmButtonText: '确定',\r\n          cancelButtonText: '取消',\r\n          type: 'warning'\r\n        }).then(() => {\r\n          delObj(this.currentId).then(() => {\r\n            this.getList()\r\n            this.resetForm()\r\n            this.onCancel()\r\n            this.$notify({\r\n              title: '成功',\r\n              message: '删除成功',\r\n              type: 'success',\r\n              duration: 2000\r\n            })\r\n          })\r\n        })\r\n      },\r\n      update() {\r\n        putObj(this.form).then(() => {\r\n          this.getList()\r\n          this.$notify({\r\n            title: '成功',\r\n            message: '更新成功',\r\n            type: 'success',\r\n            duration: 2000\r\n          })\r\n        })\r\n      },\r\n      create() {\r\n        addObj(this.form).then(() => {\r\n          this.getList()\r\n          this.$notify({\r\n            title: '成功',\r\n            message: '创建成功',\r\n            type: 'success',\r\n            duration: 2000\r\n          })\r\n        })\r\n      },\r\n      onCancel() {\r\n        this.formEdit = true\r\n        this.formStatus = ''\r\n      },\r\n      resetForm() {\r\n        this.form = {\r\n          permission: undefined,\r\n          name: undefined,\r\n          menuId: undefined,\r\n          parentId: this.currentId,\r\n          icon: undefined,\r\n          sort: undefined,\r\n          component: undefined,\r\n          type: undefined,\r\n          path: undefined\r\n        }\r\n      }\r\n    }\r\n  }\r\n</script>\r\n\r\n"],"sourceRoot":"src/views/admin/menu"}]}